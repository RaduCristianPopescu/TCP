Popescu Radu Cristian 325CB

In primul rand am serverul,am initializat serverul si dupa care am creat socketi pentru tcp si udp, dar mai intai opresc algoritmul Nagle, portul tcp fiind responsabil de listen. Dupa care incepe prelucrarea, intru intr-un loop in care ies daca primesc comanda exit. Altfel iterez prin clienti, daca primesc udp verific care clienti sunt abonati la topicurile diferite si trimit mesaj catre clienti. Daca gasesc tcp ii accept. Astfel daca nu intra pe niciun caz problema mea se sparge in 4 mici problema. Prima cand clientul se deconecteaza si eu il elimin din structura mea de clienti. Daca primesc id verific daca deja exista sau este un id nou. Si ultimele 2 cazuri daca am subscribe sau unsubscribe. In subscriber trimit prima oara id-ul clientul respectiv impreuna cu un code. Am ales sa folosesc pentru a imi permite sa prelucrez datele cand fac receive astfel: code = 0 inseamna id, code = 1 inseamna subscribe, code = 2 inseamna unsubscribe. Daca intampin o comanda precum subscribe sau unsubscribe trimit serverul datele respective. La final daca primesc de la udp afisez datele conform cerintei. Ca structuri am ales sa fac un vector de clienti, un client are un socket atribuit, un id, si statusul(conectat sau deconectat), pentru topicuri folosesc un map cheie fiind topicul si valoarea alt map si la acel map cheia fiind id-ul clientului si o valoare pentru a verifica daca este abonat. tcp message pur si simplu contine code-ul explicat mai sus si id-ul, iar udp-ul contine topic-ul type-ul si payload-ul(puteam pune si port/ip dar treceau testele si fara).
